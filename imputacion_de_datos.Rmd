---
title: "imputacion_de_datos"
author: "Equipo 7"
date: "2025-08-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(zoo)
library(imputeTS)
```

```{r}
ts_CE <- ts(dataset_CE, start = c(2024, 1), frequency = 24)
```
Function	Description
na_interpolation	Missing Value Imputation by Interpolation 
na_kalman	Missing Value Imputation by Kalman Smoothing
na_locf	Missing Value Imputation by Last Observation Carried Forward
na_ma	Missing Value Imputation by Weighted Moving Average
na_mean	Missing Value Imputation by Mean Value
na_random	Missing Value Imputation by Random Sample
na_remove	Remove Missing Values
na_replace	Replace Missing Values by a Defined Value
na_seadec	Seasonally Decomposed Missing Value Imputation
na_seasplit	Seasonally Splitted Missing Value Imputation

Function	Description
ggplot_na_distribution	Visualize Distribution of Missing Values
ggplot_na_distribution2	Missing Values Summarized in Intervals
ggplot_na_gapsize	Visualize Distribution of NA Gapsizes
ggplot_na_imputations	Visualize Imputed Values

```{r}
dataset_CE_interpolado <- na_interpolation(ts_CE)
cor(dataset_CE_interpolado[, -1], use = "pairwise.complete.obs")
```

```{r}
names_CE <- colnames(dataset_CE_interpolado)

for (i in 1:length(names_CE)) {
  
  qqnorm(dataset_CE_interpolado[, i], main = paste("Q-Q Plot of", names_CE[i]))
  
  qqline(dataset_CE_interpolado[, i], col = "red")
}
```
```{r}
for (i in 1:length(names_CE)) {
  
  boxplot(dataset_CE_interpolado[, i], main = paste("Boxplot of", names_CE[i]))
}
```

########################################
```{r}
pairs_CE <- pairs(dataset_CE_interpolado)
png("pairs_CE.png")
pairs_CE
dev.off()
```
```{r}
M <- cor(dataset_CE[, -1], use = "pairwise.complete.obs")
image(1:ncol(M), 1:ncol(M), M, axes = FALSE, main = "Correlation Heatmap")
axis(1, at = 1:ncol(M), labels = colnames(M), las=2, cex.axis=0.7)
axis(2, at = 1:ncol(M), labels = colnames(M), las=2, cex.axis=0.7)

```
```{r}
pca <- prcomp(na.omit(dataset_CE[, -1]), scale. = TRUE)
biplot(pca)
```
#############################################
```{r}
#dataset_CE_arima <- na_kalman(ts_CE[, 1:5], model = "auto.arima")
#cor(dataset_CE_arima[, -1], use = "pairwise.complete.obs")
```

```{r}
#for (i in 1:length(names_CE)) {
  
 # qqnorm(dataset_CE_arima[, i], main = paste("Q-Q Plot of", names_CE[i]))
  
#  qqline(dataset_CE_arima[, i], col = "red")
#}
```

```{r}
#dataset_CE_struct <- na_kalman(ts_CE, model = "StructTS")
#cor(dataset_CE_struct[, -1], use = "pairwise.complete.obs")
```


```{r}
dataset_CE_LOFC <- na_locf(ts_CE)
cor(dataset_CE_LOFC[, -1], use = "pairwise.complete.obs")
```

```{r}
for (i in 1:length(names_CE)) {
  
  qqnorm(dataset_CE_LOFC[, i], main = paste("Q-Q Plot of", names_CE[i]))
  
  qqline(dataset_CE_LOFC[, i], col = "red")
}
```

```{r}
dataset_CE_LOFC2 <- na_locf(ts_CE, option = 'nocb')
cor(dataset_CE_LOFC2[, -1], use = "pairwise.complete.obs")
```

```{r}
for (i in 1:length(names_CE)) {
  
  qqnorm(dataset_CE_LOFC2[, i], main = paste("Q-Q Plot of", names_CE[i]))
  
  qqline(dataset_CE_LOFC2[, i], col = "red")
}
```

```{r}
dataset_CE_decom <- na_seadec(ts_CE, algorithm = "interpolation")
cor(ts_CE[, -1], use = "pairwise.complete.obs")
```

```{r}
for (i in 1:length(names_CE)) {
  
  qqnorm(dataset_CE_decom[, i], main = paste("Q-Q Plot of", names_CE[i]))
  
  qqline(dataset_CE_decom[, i], col = "red")
}
```

```{r}
dataset_CE_split <-na_seasplit(ts_CE, algorithm = "interpolation")
cor(ts_CE[, -1], use = "pairwise.complete.obs")
```

```{r}
for (i in 1:length(names_CE)) {
  
  qqnorm(dataset_CE_split[, i], main = paste("Q-Q Plot of", names_CE[i]))
  
  qqline(dataset_CE_split[, i], col = "red")
}
```
